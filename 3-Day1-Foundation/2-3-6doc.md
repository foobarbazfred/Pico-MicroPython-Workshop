# モーションセンサの接続

- IMU (イナーシャル・メジャーメント・ユニット)
- 6-Axis MEMS MotionTracking™ Device
- I2Cで接続、3.3V電源です


```
>>> hex(i2c.scan()[0])
'0x68'
```

MPU-6050用のドライバが提供されていますのでこれを使用します。
多くのドライバは呼び出し側でI2Cバスを初期化して引数として渡しますが、mpu6050用ドライバ(mpu6050)では
ドライバ側でI2Cを初期化します。引数としてはI2CのチャンネルとGPIO番号を指定します。

```
 self.i2c = I2C(id=bus, scl=Pin(sclpin), sda=Pin(sdapin), freq=400000)
```
```
from mpu6050 import MPU6050
import time

G = 9.8
mpu = MPU6050(0, 5, 4)     #bus(0), SCL(GP5), SDA(GP4)
mpu.MPU_Init() #initialize the MPU6050
time.sleep(1)  #waiting for MPU6050 to work steadily

while True:
    accel = mpu.MPU_Get_Accelerometer() #gain the values of Acceleration
    gyro = mpu.MPU_Get_Gyroscope()      #gain the values of Gyroscope
    print('----------------------------------------')
    print('raw accel:', accel)
    print('raw gyro:', gyro)
    print('----------------------------------------')
    print('accel:', (accel[0]/16384, accel[1]/16384, accel[2]/16384))
    print('gyro:', (gyro[0]/131, gyro[1]/131, gyro[2]/131))
    print('----------------------------------------')
    time.sleep(1)


```

```
import time
from machine import Pin
from machine import I2C
from I2C_LCD import I2CLcd
from mpu6050 import MPU6050

LCD_ADDR = 0x27
i2c_1 = I2C(1, scl=Pin(19), sda=Pin(18), freq=400_000)
lcd = I2CLcd(i2c_1, LCD_ADDR, 2, 16)

G = 9.8
mpu = MPU6050(0, 5, 4)     #bus(0), SCL(GP5), SDA(GP4)
mpu.MPU_Init() #initialize the MPU6050
time.sleep(1)  #waiting for MPU6050 to work steadily

while True:
    accel = mpu.MPU_Get_Accelerometer() #gain the values of Acceleration
    gyro = mpu.MPU_Get_Gyroscope()      #gain the values of Gyroscope
    print('----------------------------------------')
    print('raw accel:', accel)
    print('raw gyro:', gyro)
    print('----------------------------------------')
    print('accel:', (accel[0]/16384, accel[1]/16384, accel[2]/16384))
    print('gyro:', (gyro[0]/131, gyro[1]/131, gyro[2]/131))
    print('----------------------------------------')
    lcd.clear()
    lcd.putstr(f'{accel[0]/16384:.1f},{accel[1]/16384:.1f},{accel[2]/16384:.1f}\n')
    #lcd.putstr(f'X:{gyro[0]/131:2.0f} Y:{gyro[1]/131:2.0f} Z:{gyro[2]/131:2.0f}')
    time.sleep(0.2)


```
## 組み合わせ例
1. モーションセンサとLCDキャラクタディスプレイ
   - モーションセンサを傾けると、傾きに応じてディスプレイの表示が左右に揺れる
2. モーションセンサとカラーLED
   - モーションセンサの回転に合わせてカラーLEDの点灯位置が回る
     

### 参考資料
- https://github.com/Freenove/Freenove_Ultimate_Starter_Kit_for_Raspberry_Pi_Pico/blob/master/Python/Python_Libraries/mpu6050.py
- https://product.tdk.com/ja/search/sensor/mortion-inertial/imu/info?part_no=MPU-6050
- https://invensense.tdk.com/wp-content/uploads/2015/02/MPU-6000-Register-Map1.pdf
